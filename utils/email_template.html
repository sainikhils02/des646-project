class EmailService:
    """Handle email functionality for audit reports"""
    
    @staticmethod
    def send_audit_email(to_email: str, subject: str, body: str, attachments: List[Path] = None):
        """Send audit report via email"""
        try:
            # This is a simplified version - you'll need to configure your SMTP settings
            smtp_server = "smtp.gmail.com"
            port = 587
            sender_email = os.getenv("EMAIL_USER", "your-email@gmail.com")
            sender_password = os.getenv("EMAIL_PASSWORD", "your-app-password")
            
            if sender_email == "your-email@gmail.com":
                st.warning("⚠️ Please configure email settings in environment variables")
                return False
            
            # Fix: Use correct class names
            message = MIMEMultipart()
            message["From"] = sender_email
            message["To"] = to_email
            message["Subject"] = subject
            
            # Fix: Use correct class name
            message.attach(MIMEText(body, "html"))
            
            # Add attachments
            if attachments:
                for attachment in attachments:
                    if attachment.exists():
                        part = MIMEBase('application', 'octet-stream')
                        with open(attachment, 'rb') as file:
                            part.set_payload(file.read())
                        encoders.encode_base64(part)
                        part.add_header(
                            'Content-Disposition',
                            f'attachment; filename={attachment.name}'
                        )
                        message.attach(part)
            
            # Send email
            server = smtplib.SMTP(smtp_server, port)
            server.starttls()
            server.login(sender_email, sender_password)
            server.send_message(message)
            server.quit()
            
            return True
            
        except Exception as e:
            st.error(f"Failed to send email: {e}")
            return False